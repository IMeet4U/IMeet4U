<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>IMEET4U - Single-Page Application</title>
  <style>
    /* CSS Variables & Reset */
    :root {
      --color-primary: #FF6B6B;
      --color-secondary: #4ECDC4;
      --color-bg: #f7f7f7;
      --color-text: #333;
      --color-light: #fff;
      --color-muted: #666;
      --radius: 8px;
      --color-accent: #FFD700;
    }
    [data-theme="dark"] {
      --color-bg: #222;
      --color-text: #ddd;
      --color-light: #333;
      --color-muted: #aaa;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    html{font-size:16px;}
    body{font-family:'PingFang TC','Noto Sans TC',sans-serif;color:var(--color-text);background:var(--color-bg);}
    a, button{font-family:'PingFang TC','Noto Sans TC',sans-serif;text-decoration:none;color:inherit;background:none;border:none;cursor:pointer;}
    img{max-width:100%;height:auto;display:block;}

    /* Header */
    header{background:var(--color-light);padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
    .logo{font-size:1.5rem;font-weight:bold;color:var(--color-primary);}
    nav{display:flex;align-items:center;}
    nav a, nav button{margin-left:1rem;font-weight:500;color:var(--color-primary);transition: color 0.3s;}
    nav a:hover, nav button:hover {color: var(--color-secondary);}
    .btn-primary{padding:.75rem 1.5rem;background:var(--color-primary);color:var(--color-light);border-radius:var(--radius);transition: background 0.3s;}
    .btn-primary:hover {background: var(--color-secondary);}
    #auth-area{display:flex;align-items:center;}
    #sign-out{display:none;margin-left:1rem;font-weight:500;color:var(--color-primary);}
    #user-email{display:none;padding:.75rem;color:var(--color-text);}
    .nav-item{display:none;}
    .nav-item.visible{display:inline-block;}

    /* SPA Pages + Transitions */
    .page{display:none;padding:2rem;opacity:0;transition:opacity .3s;}
    .page.active{display:block;opacity:1;}

    /* Hero */
    .hero{text-align:center;padding:4rem 2rem;background:linear-gradient(135deg,var(--color-primary) 0%,var(--color-secondary) 100%);color:var(--color-light);}
    .hero h1{font-size:2.5rem;line-height:1.2;margin-bottom:1rem;}
    .hero p{margin-bottom:2rem;font-size:1.125rem;}

    /* Features */
    .features{padding:3rem 2rem;background:var(--color-light);display:grid;gap:2rem;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));}
    .feature-card{background:var(--color-light);padding:1.5rem;border-radius:var(--radius);box-shadow:0 1px 3px rgba(0,0,0,0.1);text-align:center;transition:transform .2s;}
    .feature-card:hover{transform:translateY(-5px);}
    .feature-card h3{margin:1rem 0 .5rem;font-size:1.25rem;color:var(--color-primary);}
    .feature-card p{font-size:1rem;color:var(--color-muted);}

    /* About */
    #about p{max-width:600px;margin:1rem auto;line-height:1.6;}
    .team-section {max-width:1000px;margin:30px auto;text-align:center;}
    .team-members{display:flex;justify-content:space-around;flex-wrap:wrap;gap:20px;}
    .member{flex:1 1 200px;max-width:220px;margin:10px;text-align:center;display:flex;flex-direction:column;align-items:center;}
    .member img{width:200px;height:200px;border-radius:50%;object-fit:cover;border:3px solid var(--color-accent);margin-bottom:10px;}
    .member h3{margin:0 0 5px;font-size:1.2em;line-height:1.2;}
    .member p{margin:0;color:#666;line-height:1.2;}

    /* Match */
    #match {padding: 2rem 5%; max-width: 1200px; margin: 0 auto;}
    #match h2 {text-align: center; margin-bottom: 2rem; font-size: 2rem; color: var(--color-primary);}
    #match .step-header {text-align: center; margin-bottom: 1.5rem; font-size: 1.25rem; color: var(--color-muted);}
    #match .selection-list{display:flex;gap:1rem;margin-bottom:2rem;justify-content:center;flex-wrap:wrap;}
    #match .selection-list button{
      padding:.75rem 1.5rem;
      border:2px solid var(--color-primary);
      border-radius:var(--radius);
      background:var(--color-light);
      color:var(--color-primary);
      font-weight:500;
      transition: all 0.3s;
    }
    #match .selection-list button:hover{
      background:var(--color-primary);
      color:var(--color-light);
    }
    #match .selection-list button.active{
      background:var(--color-primary);
      color:var(--color-light);
    }
    #match .event-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }
    #match .card{
      background:var(--color-light);
      padding:1.5rem;
      border-radius:var(--radius);
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
      text-align:center;
      transition: transform 0.3s;
      position: relative;
      border-left: 5px solid var(--color-primary);
    }
    #match .card:hover {
      transform: translateY(-5px);
    }
    #match .card h3 {
      color: var(--color-primary);
      margin-bottom: 0.5rem;
    }
    #match .card p {
      color: var(--color-muted);
      margin: 0.3rem 0;
    }
    #match button.register-btn{
      padding:.75rem 1.5rem;
      background:var(--color-primary);
      color:var(--color-light);
      border-radius:var(--radius);
      margin-top:1rem;
      transition: background 0.3s;
    }
    #match button.register-btn:hover{
      background:var(--color-secondary);
    }
    #match button.register-btn:disabled{
      background:var(--color-muted);
      cursor:not-allowed;
    }
    #match button.cancel-btn{
      padding:.75rem 1.5rem;
      background:#ff4444;
      color:var(--color-light);
      border-radius:var(--radius);
      margin-top:1rem;
      transition: background 0.3s;
    }
    #match button.cancel-btn:hover{
      background:#cc0000;
    }
    #match .no-events{
      color:var(--color-muted);
      text-align:center;
      margin-top:1rem;
    }
    #match .selected-info{
      margin-top:1rem;
      font-weight:bold;
      text-align:center;
      color: var(--color-primary);
      background: rgba(255, 107, 107, 0.1);
      padding: 0.5rem;
      border-radius: var(--radius);
    }
    #match .action-buttons{
      display:flex;
      justify-content:center;
      gap:1rem;
      margin-bottom: 2rem;
    }
    #match .action-buttons button{
      padding:.75rem 1.5rem;
      border:2px solid var(--color-secondary);
      border-radius:var(--radius);
      background:var(--color-light);
      color:var(--color-secondary);
      font-weight:500;
      transition: all 0.3s;
    }
    #match .action-buttons button:hover{
      background:var(--color-secondary);
      color:var(--color-light);
    }

    /* Chat */
    #chat #chat-window{background:var(--color-light);border:1px solid #ccc;border-radius:4px;height:300px;overflow-y:auto;padding:1rem;}
    #chat .input-group{display:flex;margin-top:1rem;max-width:400px;}
    #chat input{flex:1;padding:.5rem;border:1px solid #ccc;border-radius:4px 0 0 4px;}
    #chat button{padding:.5rem 1rem;border:1px solid #ccc;border-left:none;border-radius:0 4px 4px 0;}

    /* Forms */
    .form-container{max-width:400px;margin:3rem auto;background:var(--color-light);padding:2rem;border-radius:var(--radius);box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    .form-container h2{margin-bottom:1rem;}
    .form-container label{display:block;margin-bottom:1rem;}
    .form-container input,.form-container select,.form-container textarea{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:4px;}
    .form-container button{width:100%;padding:.75rem;background:var(--color-primary);color:var(--color-light);border-radius:var(--radius);}

    /* Survey Specific Styles */
    .form-container .survey-question{margin-bottom:1.5rem;}
    .form-container .survey-question label{font-weight:bold;margin-bottom:.5rem;}
    .form-container .survey-question div{display:flex;flex-wrap:wrap;gap:10px;}
    .form-container .survey-question input[type="checkbox"],.form-container .survey-question input[type="radio"]{width:auto;margin-right:5px;}
    .form-container .survey-question span{margin-right:15px;}

    /* Modal */
    .modal-backdrop{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;}
    .modal-backdrop.active{display:flex;}
    .modal{background:var(--color-light);padding:2rem;border-radius:var(--radius);max-width:500px;width:90%;max-height:90%;overflow:auto;}

    /* Calendar */
    .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;max-width:600px;margin:0 auto;}
    .calendar .header{font-weight:bold;color:var(--color-primary);text-align:center;padding:.5rem;}
    .calendar div{padding:.5rem;text-align:center;border-radius:4px;background:var(--color-light);min-height:60px;}
    .calendar .empty{background:transparent;}
    .calendar .today{background:#87CEEB;color:#fff;}
    .calendar .event-day{background:#FF6B6B;}
    .calendar .event-details{font-size:0.8rem;color:#000000;margin-top:5px;}

    /* Footer */
    footer{text-align:center;padding:2rem 0;}

    /* Debug Output */
    #debug-output{margin-top:1rem;color:#d32f2f;font-size:.9rem;word-wrap:break-word;}

    @media(max-width:768px){
      header{padding:1rem;}
      nav a,nav button{margin-left:.75rem;font-size:.9rem;}
      .hero h1{font-size:2rem;}
      .hero p{font-size:1rem;}
      .features{padding:2rem 1rem;}
      #match {padding: 2rem 3%;}
      #match .event-grid {grid-template-columns: 1fr;}
      .calendar{max-width:100%;grid-template-columns:repeat(7,1fr);}
      .calendar div{padding:.3rem;min-height:50px;}
      .calendar .event-details{font-size:0.7rem;}
    }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, get, push, update, remove } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendPasswordResetEmail, fetchSignInMethodsForEmail } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyALscFG5EEzN5KanfiXzdw59nxh62z81OA",
      authDomain: "imeet4u-98171.firebaseapp.com",
      databaseURL: "https://imeet4u-98171-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "imeet4u-98171",
      storageBucket: "imeet4u-98171.firebasestorage.app",
      messagingSenderId: "979771631163",
      appId: "1:979771631163:web:2d8bf880b8a1b2c0295e1e",
      measurementId: "G-5LWNP5H2SP"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const database = getDatabase(app);

    window.writedata = async function() {
      var email = document.getElementById("userEmail").value.toLowerCase().trim();
      var password = document.getElementById("userPassword").value;
      var confirmPassword = document.getElementById("userCPassword").value;

      if (!email || !password || !confirmPassword) {
        alert("Please fill in all fields.");
        return;
      }

      if (password !== confirmPassword) {
        alert("Passwords do not match!");
        return;
      }

      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        const newUserRef = push(ref(database, '/users'));
        await set(newUserRef, {email: email, uid: user.uid});
        const signInMethods = await fetchSignInMethodsForEmail(auth, email);
        console.log("Registration completed for", email, "UID:", user.uid, "Providers:", user.providerData, "Sign-in methods:", signInMethods);
        alert("User registered successfully!");
        document.getElementById("register-form").reset();
        location.hash = "login";
      } catch (error) {
        console.error("Error registering user:", error);
        alert("Failed to register: " + error.message);
      }
    };

    window.selectdata = function() {
      const dbRef = ref(database, '/users');
      onValue(dbRef, (snapshot) => {
        const data = snapshot.val();
        var html_text = "";
        if (data) {
          for (let key in data) {
            html_text += "<a href=\"#\" id=\"t" + key + "\" onClick=\"selectid('" + key + "')\">Á¨¨" + key + "Á≠Ü</a><ol><li id=\"z1_value_2_" + key + "\">" + data[key].email + "</li></ol><br>";
          }
        }
      }, (error) => {
        console.error("Error reading data:", error);
      });
    };

    window.selectid = function(id) {
      window.select_id = id;
      alert("Selected record: " + id);
    };

    async function checkUserProgress(user) {
      const profileRef = ref(database, '/profiles/' + user.uid);
      const surveyRef = ref(database, '/surveys/' + user.uid);
      const profileSnapshot = await get(profileRef);
      const surveySnapshot = await get(surveyRef);
      return {hasProfile: profileSnapshot.exists(), hasSurvey: surveySnapshot.exists()};
    }

    window.updateNavigation = function(user, hasProfile, hasSurvey, isLoggedIn = false) {
      const authArea = document.getElementById('auth-area');
      const userEmail = document.getElementById('user-email');
      const signOutBtn = document.getElementById('sign-out');
      const navItems = document.querySelectorAll('.nav-item');

      if (user && isLoggedIn) {
        authArea.style.display = 'none';
        userEmail.textContent = user.email;
        userEmail.style.display = 'block';
        signOutBtn.style.display = 'inline-block';
        if (hasProfile && hasSurvey) {
          navItems.forEach(item => item.classList.add('visible'));
        } else {
          navItems.forEach(item => {
            if (item.id === 'nav-home' || item.id === 'nav-about') {
              item.classList.add('visible');
            } else {
              item.classList.remove('visible');
            }
          });
        }
      } else {
        authArea.style.display = 'flex';
        userEmail.style.display = 'none';
        signOutBtn.style.display = 'none';
        navItems.forEach(item => item.classList.remove('visible'));
      }
    };

    window.signOutUser = async function() {
      try {
        await signOut(auth);
        alert("Logged out successfully!");
        location.hash = "home";
        window.updateNavigation(null, false, false, false);
      } catch (error) {
        console.error("Error signing out:", error);
        alert("Failed to sign out: " + error.message);
      }
    };

    window.logindata = async function() {
      var email = document.querySelector("#login-form [name='username']").value.toLowerCase().trim();
      var password = document.querySelector("#login-form [name='password']").value;

      if (!email || !password) {
        alert("Please fill in all fields.");
        return;
      }

      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        alert("Login successful!");
        const {hasProfile, hasSurvey} = await checkUserProgress(user);
        window.updateNavigation(user, hasProfile, hasSurvey, true);
        if (!hasProfile) {
          document.getElementById("profile-form").reset();
          location.hash = "profile";
        } else if (!hasSurvey) {
          location.hash = "survey";
        } else {
          location.hash = "home";
        }
      } catch (error) {
        console.error("Error logging in:", error);
        alert("Failed to login: " + error.message);
      }
    };

    window.resetPassword = async function() {
      var email = document.getElementById("reset-email").value.toLowerCase().trim();
      const debugOutput = document.getElementById("debug-output");
      if (!email) {
        alert("Please enter your email address.");
        return;
      }

      try {
        const usersRef = ref(database, '/users');
        const snapshot = await get(usersRef);
        let emailExists = false;

        if (snapshot.exists()) {
          const users = snapshot.val();
          for (let key in users) {
            if (users[key].email === email) {
              emailExists = true;
              break;
            }
          }
        }

        if (!emailExists) {
          alert("This account does not exist in our records. Please register first.");
          debugOutput.textContent = `Email ${email} not found in database.`;
          return;
        }

        await sendPasswordResetEmail(auth, email);
        alert("Password reset email sent! Please check your inbox.");
        debugOutput.textContent = "Password reset email sent successfully.";
        document.getElementById("forgot-password-form").reset();
        location.hash = "login";
      } catch (error) {
        console.error("Error:", error);
        debugOutput.textContent = `Error: ${error.code || error.message} - Details: ${JSON.stringify(error)}`;
        if (error.code === 'auth/invalid-email') {
          alert("Invalid email format. Please try again.");
        } else if (error.code === 'auth/too-many-requests') {
          alert("Too many requests. Please try again later.");
        } else {
          alert("Failed to send reset email: " + error.message);
        }
      }
    };

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        const {hasProfile, hasSurvey} = await checkUserProgress(user);
        const profileRef = ref(database, '/profiles/' + user.uid);
        onValue(profileRef, (snapshot) => {
          const data = snapshot.val();
          if (data) {
            document.querySelector("#profile-form [name='name']").value = data.name || '';
            document.querySelector("#profile-form [name='bio']").value = data.bio || '';
          }
        });

        const surveyRef = ref(database, '/surveys/' + user.uid);
        onValue(surveyRef, (snapshot) => {
          const data = snapshot.val();
          if (data) {
            if (data.favoriteSport) data.favoriteSport.forEach(sport => document.querySelector(`input[name="favoriteSport"][value="${sport}"]`).checked = true);
            if (data.freeTimeActivities) data.freeTimeActivities.forEach(activity => document.querySelector(`input[name="freeTimeActivities"][value="${activity}"]`).checked = true);
            if (data.timeOnHobbies) document.querySelector(`input[name="timeOnHobbies"][value="${data.timeOnHobbies}"]`).checked = true;
            if (data.musicPreference) data.musicPreference.forEach(music => document.querySelector(`input[name="musicPreference"][value="${music}"]`).checked = true);
            if (data.bookPreference) data.bookPreference.forEach(book => document.querySelector(`input[name="bookPreference"][value="${book}"]`).checked = true);
            if (data.moviePreference) data.moviePreference.forEach(movie => document.querySelector(`input[name="moviePreference"][value="${movie}"]`).checked = true);
            if (data.personalityRating) document.querySelector(`input[name="personalityRating"][value="${data.personalityRating}"]`).checked = true;
          }
        });

        window.updateNavigation(user, hasProfile, hasSurvey, false);
      } else {
        window.updateNavigation(null, false, false, false);
        location.hash = "home";
      }
    });

    selectdata();

    window.saveProfile = async function() {
      var name = document.querySelector("#profile-form [name='name']").value;
      var bio = document.querySelector("#profile-form [name='bio']").value;

      if (!name || !bio) {
        alert("Please fill in all fields.");
        return;
      }

      const user = auth.currentUser;
      if (user) {
        await set(ref(database, '/profiles/' + user.uid), {name: name, bio: bio});
        alert("Profile saved successfully!");
        const {hasSurvey} = await checkUserProgress(user);
        if (hasSurvey) location.hash = "home"; else location.hash = "survey";
      }
    };

    window.saveSurvey = async function() {
      const user = auth.currentUser;
      if (!user) {
        alert("Please log in to save your survey.");
        return;
      }

      const favoriteSportInputs = document.querySelectorAll('input[name="favoriteSport"]:checked');
      const freeTimeActivitiesInputs = document.querySelectorAll('input[name="freeTimeActivities"]:checked');
      const timeOnHobbiesInput = document.querySelector('input[name="timeOnHobbies"]:checked');
      const musicPreferenceInputs = document.querySelectorAll('input[name="musicPreference"]:checked');
      const bookPreferenceInputs = document.querySelectorAll('input[name="bookPreference"]:checked');
      const moviePreferenceInputs = document.querySelectorAll('input[name="moviePreference"]:checked');
      const personalityRatingInput = document.querySelector('input[name="personalityRating"]:checked');

      if (favoriteSportInputs.length > 2) {
        alert("Please select up to 2 options for Favorite Sport.");
        return;
      }
      if (freeTimeActivitiesInputs.length > 2) {
        alert("Please select up to 2 options for Free Time Activities.");
        return;
      }
      if (!timeOnHobbiesInput) {
        alert("Please select an option for Time Spent on Hobbies.");
        return;
      }
      if (musicPreferenceInputs.length > 2) {
        alert("Please select up to 2 options for Music Preference.");
        return;
      }
      if (bookPreferenceInputs.length > 2) {
        alert("Please select up to 2 options for Book Preference.");
        return;
      }
      if (moviePreferenceInputs.length > 2) {
        alert("Please select up to 2 options for Movie Preference.");
        return;
      }
      if (!personalityRatingInput) {
        alert("Please select an option for Personality Rating.");
        return;
      }

      const favoriteSport = Array.from(favoriteSportInputs).map(input => input.value);
      const freeTimeActivities = Array.from(freeTimeActivitiesInputs).map(input => input.value);
      const timeOnHobbies = timeOnHobbiesInput.value;
      const musicPreference = Array.from(musicPreferenceInputs).map(input => input.value);
      const bookPreference = Array.from(bookPreferenceInputs).map(input => input.value);
      const moviePreference = Array.from(moviePreferenceInputs).map(input => input.value);
      const personalityRating = personalityRatingInput.value;

      await set(ref(database, '/surveys/' + user.uid), {
        favoriteSport: favoriteSport,
        freeTimeActivities: freeTimeActivities,
        timeOnHobbies: timeOnHobbies,
        musicPreference: musicPreference,
        bookPreference: bookPreference,
        moviePreference: moviePreference,
        personalityRating: personalityRating,
        completed: true
      });

      alert("Survey saved successfully!");
      location.hash = "home";
      const {hasProfile, hasSurvey} = await checkUserProgress(user);
      window.updateNavigation(user, hasProfile, hasSurvey, true);
    };

    function limitCheckboxSelection(name) {
      const checkboxes = document.querySelectorAll(`input[name="${name}"]`);
      checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function(e) {
          const checkedBoxes = document.querySelectorAll(`input[name="${name}"]:checked`);
          if (checkedBoxes.length > 2) {
            e.preventDefault();
            this.checked = false;
            alert("You can only select up to 2 options. Please uncheck one option to select a new one.");
          }
        });
      });
    }

    // Ê¥ªÂãïÊôÇÈñìË°®ÔºàÊØèÂÄãÁ∏£Â∏ÇÈÉΩÊúâÊâÄÊúâÊ¥ªÂãïÔºâ
    const cities = ["Taipei", "Kaohsiung", "Taichung", "Tainan", "Hsinchu", "Taoyuan", "Keelung"];
    const activities = [
      { name: "Basketball", category: "Sports", locationTemplate: "%s Arena" },
      { name: "Volleyball", category: "Sports", locationTemplate: "%s Gymnasium" },
      { name: "Badminton", category: "Sports", locationTemplate: "%s Sports Center" },
      { name: "Tennis", category: "Sports", locationTemplate: "%s Tennis Court" },
      { name: "Pool", category: "Sports", locationTemplate: "%s Pool Club" },
      { name: "Table Tennis", category: "Sports", locationTemplate: "%s Sports Hall" },
      { name: "Singing", category: "Music", locationTemplate: "%s Cultural Center" },
      { name: "Dancing", category: "Music", locationTemplate: "%s Performing Arts Center" }
    ];
    const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    const times = ["4:00 PM", "6:00 PM", "7:00 PM", "8:00 PM", "9:00 PM"];

    const weeklyEvents = [];
    let eventId = 1;
    cities.forEach(city => {
      activities.forEach((activity, activityIndex) => {
        const day = days[eventId % days.length];
        const time = times[eventId % times.length];
        weeklyEvents.push({
          id: String(eventId++),
          name: activity.name,
          category: activity.category,
          day: day,
          time: time,
          city: city,
          location: activity.locationTemplate.replace("%s", city)
        });
      });
    });

    // ÂÑ≤Â≠òÁï∂ÂâçÈÅ∏ÊìáÁöÑÁãÄÊÖã
    let selectedCity = '';
    let selectedActivity = '';
    let selectedEventId = '';
    let currentStep = 'city'; // ËøΩËπ§Áï∂ÂâçÊ≠•È©ü: 'city', 'activity', 'time'

    // ÂàùÂßãÂåñÊ¥ªÂãïÂà∞Ë≥áÊñôÂ∫´
    async function initializeEvents() {
      const eventsRef = ref(database, '/eventRegistrations');
      const snapshot = await get(eventsRef);
      if (!snapshot.exists()) {
        const eventsData = {};
        const now = new Date("2025-05-18T18:01:00Z"); // Áï∂ÂâçÊôÇÈñìÔºö06:01 PM CST (UTC+8)
        weeklyEvents.forEach(event => {
          const eventDate = getEventDate(event.day, event.time, now);
          if (eventDate > now) {
            eventsData[event.id] = {
              name: event.name,
              category: event.category,
              day: event.day,
              time: event.time,
              city: event.city,
              location: event.location,
              maxParticipants: 20,
              registeredUsers: {},
              waitlist: {}
            };
          }
        });
        await set(eventsRef, eventsData);
      }
    }

    // Áç≤ÂèñÊ¥ªÂãïÊó•Êúü
    function getEventDate(day, time, now) {
      const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
      const todayIndex = now.getDay();
      const targetIndex = days.indexOf(day);
      let diff = targetIndex - todayIndex;
      if (diff < 0) diff += 7; // ‰∏ã‰∏ÄÈÄ±
      if (diff > 14) diff -= 7; // ÈôêÂà∂ÂÖ©ÈÄ±ÂÖß
      const eventDate = new Date(now);
      eventDate.setDate(now.getDate() + diff);
      const [hours, minutes] = time.match(/\d+/g);
      eventDate.setHours(parseInt(hours) + 8, parseInt(minutes), 0, 0); // Ë™øÊï¥ÁÇ∫ CST
      return eventDate;
    }

    // Êõ¥Êñ∞ÊâÄÈÅ∏Ê¥ªÂãïË≥áË®ä
    function updateSelectedInfo() {
      const selectedInfo = document.getElementById('selected-info');
      if (selectedCity && selectedActivity) {
        selectedInfo.textContent = `Selected: ${selectedActivity} in ${selectedCity}`;
      } else if (selectedCity) {
        selectedInfo.textContent = `Selected City: ${selectedCity}`;
      } else {
        selectedInfo.textContent = '';
      }
    }

    // È°ØÁ§∫Á∏£Â∏ÇÈÅ∏ÂñÆ
    function displayCities() {
      currentStep = 'city';
      selectedCity = '';
      selectedActivity = '';
      selectedEventId = '';
      updateSelectedInfo();

      const swipeContainer = document.getElementById('swipe-container');
      swipeContainer.innerHTML = '';
      const stepHeader = document.createElement('div');
      stepHeader.className = 'step-header';
      stepHeader.textContent = 'Step 1: Choose a City';
      swipeContainer.appendChild(stepHeader);

      const cities = [...new Set(weeklyEvents.map(event => event.city))];
      const selectionList = document.createElement('div');
      selectionList.className = 'selection-list';
      cities.forEach(city => {
        const button = document.createElement('button');
        button.textContent = city;
        button.onclick = () => {
          selectedCity = city;
          displayActivitiesByCity(city);
          updateSelectedInfo();
        };
        selectionList.appendChild(button);
      });
      swipeContainer.appendChild(selectionList);
    }

    // È°ØÁ§∫ÁâπÂÆöÁ∏£Â∏ÇÁöÑÊ¥ªÂãï
    function displayActivitiesByCity(city) {
      currentStep = 'activity';
      selectedActivity = '';
      selectedEventId = '';
      updateSelectedInfo();

      const swipeContainer = document.getElementById('swipe-container');
      swipeContainer.innerHTML = '';
      const stepHeader = document.createElement('div');
      stepHeader.className = 'step-header';
      stepHeader.textContent = 'Step 2: Choose an Activity';
      swipeContainer.appendChild(stepHeader);

      const actionButtons = document.createElement('div');
      actionButtons.className = 'action-buttons';
      actionButtons.innerHTML = `<button onclick="window.goBack()">Back</button>`;
      swipeContainer.appendChild(actionButtons);

      const activities = [...new Set(weeklyEvents.filter(event => event.city === city).map(event => event.name))];
      const selectionList = document.createElement('div');
      selectionList.className = 'selection-list';
      activities.forEach(activity => {
        const button = document.createElement('button');
        button.textContent = activity;
        button.onclick = () => {
          selectedActivity = activity;
          displayTimesByActivity(city, activity);
          updateSelectedInfo();
        };
        selectionList.appendChild(button);
      });
      swipeContainer.appendChild(selectionList);
    }

    // È°ØÁ§∫ÁâπÂÆöÊ¥ªÂãïÁöÑÊôÇÈñì
    async function displayTimesByActivity(city, activity) {
      currentStep = 'time';
      selectedEventId = '';
      updateSelectedInfo();

      const user = auth.currentUser;
      const swipeContainer = document.getElementById('swipe-container');
      swipeContainer.innerHTML = '';
      const stepHeader = document.createElement('div');
      stepHeader.className = 'step-header';
      stepHeader.textContent = 'Step 3: Choose a Time and Register';
      swipeContainer.appendChild(stepHeader);

      const actionButtons = document.createElement('div');
      actionButtons.className = 'action-buttons';
      actionButtons.innerHTML = `<button onclick="window.goBack()">Back</button>`;
      swipeContainer.appendChild(actionButtons);

      const eventsRef = ref(database, '/eventRegistrations');
      const snapshot = await get(eventsRef);
      if (!snapshot.exists()) {
        const noEventsMessage = document.createElement('p');
        noEventsMessage.className = 'no-events';
        noEventsMessage.textContent = 'No events available at the moment.';
        swipeContainer.appendChild(noEventsMessage);
        return;
      }

      const events = snapshot.val();
      const now = new Date("2025-05-18T18:01:00Z");
      const eventGrid = document.createElement('div');
      eventGrid.className = 'event-grid';
      for (let eventId in events) {
        const event = events[eventId];
        const eventDate = getEventDate(event.day, event.time, now);
        if (event.city === city && event.name === activity && eventDate > now) {
          const registeredCount = event.registeredUsers ? Object.keys(event.registeredUsers).length : 0;
          const waitlistCount = event.waitlist ? Object.keys(event.waitlist).length : 0;
          const isRegistered = user && event.registeredUsers && event.registeredUsers[user.uid];
          const isOnWaitlist = user && event.waitlist && event.waitlist[user.uid];
          const isFull = registeredCount >= event.maxParticipants;

          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <h3>${event.name} - ${event.time}</h3>
            <p>Location: ${event.location}</p>
            <p>Day: ${event.day}</p>
            <p>Participants: ${registeredCount}/${event.maxParticipants}</p>
            <p>Waitlist: ${waitlistCount}</p>
            ${user ? `
              <button class="register-btn" onclick="registerForEvent('${eventId}')" 
                ${isRegistered || isOnWaitlist || !user ? 'disabled' : ''}>
                ${isRegistered ? 'Registered' : isOnWaitlist ? 'On Waitlist' : isFull ? 'Full - Join Waitlist' : 'Register'}
              </button>
              ${isRegistered ? `<button class="cancel-btn" onclick="cancelRegistration('${eventId}')">Cancel Registration</button>` : ''}
            ` : `<p>Please log in to register.</p>`}
          `;
          eventGrid.appendChild(card);
        }
      }
      swipeContainer.appendChild(eventGrid);
    }

    // ËøîÂõûÈÇèËºØ
    window.goBack = function() {
      if (currentStep === 'activity') {
        displayCities();
      } else if (currentStep === 'time') {
        displayActivitiesByCity(selectedCity);
      }
    };

    // Â†±ÂêçÊ¥ªÂãï
    window.registerForEvent = async function(eventId) {
      const user = auth.currentUser;
      if (!user) {
        alert("Please log in to register for an event.");
        return;
      }

      const eventRef = ref(database, `/eventRegistrations/${eventId}`);
      const snapshot = await get(eventRef);
      if (!snapshot.exists()) {
        alert("Event not found.");
        return;
      }

      const event = snapshot.val();
      const registeredCount = event.registeredUsers ? Object.keys(event.registeredUsers).length : 0;
      const isFull = registeredCount >= event.maxParticipants;

      if (isFull) {
        const updates = {};
        updates[`/eventRegistrations/${eventId}/waitlist/${user.uid}`] = true;
        await update(ref(database), updates);
        alert("This event is full. You've been added to the waitlist.");
      } else {
        const updates = {};
        updates[`/eventRegistrations/${eventId}/registeredUsers/${user.uid}`] = true;
        await update(ref(database), updates);
        alert("Successfully registered for the event!");
      }

      displayTimesByActivity(selectedCity, selectedActivity);
    };

    // ÂèñÊ∂àÂ†±Âêç
    window.cancelRegistration = async function(eventId) {
      const user = auth.currentUser;
      if (!user) {
        alert("Please log in to cancel registration.");
        return;
      }

      const eventRef = ref(database, `/eventRegistrations/${eventId}`);
      const snapshot = await get(eventRef);
      if (!snapshot.exists()) {
        alert("Event not found.");
        return;
      }

      const event = snapshot.val();
      const updates = {};
      updates[`/eventRegistrations/${eventId}/registeredUsers/${user.uid}`] = null;

      const waitlist = event.waitlist || {};
      const waitlistUids = Object.keys(waitlist);
      if (waitlistUids.length > 0) {
        const nextUser = waitlistUids[0];
        updates[`/eventRegistrations/${eventId}/waitlist/${nextUser}`] = null;
        updates[`/eventRegistrations/${eventId}/registeredUsers/${nextUser}`] = true;
        alert("Your registration has been canceled. The next person on the waitlist has been notified.");
      } else {
        alert("Your registration has been canceled.");
      }

      await update(ref(database), updates);
      displayTimesByActivity(selectedCity, selectedActivity);
    };

    // È°ØÁ§∫Êó•ÊõÜ
    async function displayCalendar() {
      const calendarGrid = document.getElementById('calendar-grid');
      calendarGrid.innerHTML = '';

      const now = new Date("2025-05-18T18:01:00Z"); // Áï∂ÂâçÊôÇÈñìÔºö06:01 PM CST (UTC+8)
      const year = now.getFullYear();
      const month = now.getMonth(); // 5Êúà (0-based)
      const today = now.getDate(); // 18Êó•

      // Áç≤ÂèñÁï∂ÂâçÊúà‰ªΩÁöÑÁ¨¨‰∏ÄÂ§©ÂíåÊúÄÂæå‰∏ÄÂ§©
      const firstDayOfMonth = new Date(year, month, 1);
      const lastDayOfMonth = new Date(year, month + 1, 0);
      const firstDayOfWeek = firstDayOfMonth.getDay(); // Á¨¨‰∏ÄÂ§©ÊòØÊòüÊúüÂπæ
      const daysInMonth = lastDayOfMonth.getDate(); // Áï∂ÊúàÁ∏ΩÂ§©Êï∏

      // Áç≤ÂèñÁî®Êà∂Â†±ÂêçÁöÑÊ¥ªÂãïÊó•Êúü
      const user = auth.currentUser;
      const eventDays = new Map(); // ÂÑ≤Â≠òÊ¥ªÂãïÊó•ÊúüÂíåÊ¥ªÂãïË≥áË®ä
      if (user) {
        const eventsRef = ref(database, '/eventRegistrations');
        const snapshot = await get(eventsRef);
        if (snapshot.exists()) {
          const events = snapshot.val();
          for (let eventId in events) {
            const event = events[eventId];
            if (event.registeredUsers && event.registeredUsers[user.uid]) {
              const eventDate = getEventDate(event.day, event.time, now);
              const eventDay = eventDate.getDate();
              const eventMonth = eventDate.getMonth();
              if (eventMonth === month) { // Âè™È°ØÁ§∫Áï∂ÂâçÊúà‰ªΩÁöÑÊ¥ªÂãï
                if (!eventDays.has(eventDay)) {
                  eventDays.set(eventDay, []);
                }
                eventDays.get(eventDay).push(`${event.name} at ${event.time} (${event.city})`);
              }
            }
          }
        }
      }

      // È°ØÁ§∫ÊòüÊúüÊ®ôÈ†≠
      const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      weekdays.forEach(day => {
        const header = document.createElement('div');
        header.className = 'header';
        header.textContent = day;
        calendarGrid.appendChild(header);
      });

      // Â°´ÂÖÖÁ©∫ÁôΩÂ§©Êï∏
      for (let i = 0; i < firstDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'empty';
        calendarGrid.appendChild(emptyDay);
      }

      // Â°´ÂÖÖÊó•Êúü
      for (let day = 1; day <= daysInMonth; day++) {
        const dayDiv = document.createElement('div');
        let className = '';
        if (day === today && !eventDays.has(day)) {
          className = 'today'; // Áï∂Â§©Ôºå‰ΩÜÊ≤íÊúâÊ¥ªÂãï
        }
        if (eventDays.has(day)) {
          className = 'event-day'; // ÊúâÊ¥ªÂãïÁöÑÊó•Êúü
        }
        dayDiv.className = className;
        dayDiv.innerHTML = `${day}`;
        if (eventDays.has(day)) {
          const events = eventDays.get(day);
          events.forEach(event => {
            const eventDetail = document.createElement('div');
            eventDetail.className = 'event-details';
            eventDetail.textContent = event;
            dayDiv.appendChild(eventDetail);
          });
        }
        calendarGrid.appendChild(dayDiv);
      }
    }

    // Áõ£ËÅΩÊ¥ªÂãïÊõ¥Êñ∞‰∏¶Âà∑Êñ∞Êó•ÊõÜ
    function listenForEventUpdates() {
      const eventsRef = ref(database, '/eventRegistrations');
      onValue(eventsRef, () => {
        if (selectedCity && selectedActivity) {
          displayTimesByActivity(selectedCity, selectedActivity);
        }
        // Áï∂Ê¥ªÂãïË≥áÊñôÊõ¥Êñ∞ÊôÇÔºåÈáçÊñ∞Ê∏≤ÊüìÊó•ÊõÜ
        if (document.querySelector('#calendar.active')) {
          displayCalendar();
        }
      });
    }

    window.onload = async function() {
      limitCheckboxSelection('favoriteSport');
      limitCheckboxSelection('freeTimeActivities');
      limitCheckboxSelection('musicPreference');
      limitCheckboxSelection('bookPreference');
      limitCheckboxSelection('moviePreference');

      const saved = localStorage.getItem('theme') || 'light';
      document.body.setAttribute('data-theme', saved);
      document.getElementById('dark-toggle').onclick = () => {
        const cur = document.body.getAttribute('data-theme');
        const nxt = cur === 'light' ? 'dark' : 'light';
        document.body.setAttribute('data-theme', nxt);
        localStorage.setItem('theme', nxt);
      };

      function showPage(id) {
        document.querySelectorAll('.page').forEach(p => {
          p.classList.remove('active');
          if (p.id === id) {
            p.classList.add('active');
            if (id === 'calendar') {
              displayCalendar(); // ÈÄ≤ÂÖ•Êó•ÊõÜÈ†ÅÈù¢ÊôÇÊ∏≤ÊüìÊó•ÊõÜ
            }
          }
        });
        if (id === 'login') document.getElementById('login-form').reset();
        else if (id === 'forgot-password') document.getElementById('forgot-password-form').reset();
        else if (id === 'survey') document.getElementById('survey-form').reset();
        else if (id === 'match') {
          displayCities();
        }
      }

      document.body.addEventListener('click', e => {
        const tgt = e.target.closest('[data-target]');
        if (tgt) {
          const targetPage = tgt.dataset.target;
          location.hash = targetPage;
          showPage(targetPage);
        }
      });

      window.addEventListener('hashchange', () => {
        const pageId = location.hash.slice(1) || 'home';
        showPage(pageId);
      });

      if (location.hash) {
        showPage(location.hash.slice(1));
      } else {
        location.hash = "home";
        showPage("home");
      }

      document.getElementById('send').onclick = () => {
        const msg = document.getElementById('msg').value;
        if (msg) {
          const chatWindow = document.getElementById('chat-window');
          chatWindow.innerHTML += `<p>${msg}</p>`;
          document.getElementById('msg').value = '';
          chatWindow.scrollTop = chatWindow.scrollHeight;
        }
      };

      document.getElementById('profile-form').addEventListener('submit', (e) => {
        e.preventDefault();
        window.saveProfile();
      });

      document.getElementById('settings-form').addEventListener('submit', (e) => {
        e.preventDefault();
        alert("Settings saved!");
      });

      document.getElementById('register-form').addEventListener('submit', (e) => {
        e.preventDefault();
        window.writedata();
      });

      document.getElementById('login-form').addEventListener('submit', (e) => {
        e.preventDefault();
        window.logindata();
      });

      document.getElementById('forgot-password-form').addEventListener('submit', (e) => {
        e.preventDefault();
        window.resetPassword();
      });

      document.getElementById('survey-form').addEventListener('submit', (e) => {
        e.preventDefault();
        window.saveSurvey();
      });

      updateNavigation(null, false, false, false);
      await initializeEvents();
      listenForEventUpdates();
    };

    window.onbeforeunload = function() {
      location.hash = "home";
      signOut(auth).catch(error => console.error("Error signing out on unload:", error));
    };
  </script>
</head>
<body data-theme="light">
  <header>
    <div class="logo">IMEET4U</div>
    <nav>
      <a id="nav-home" data-target="home">Home</a>
      <a id="nav-about" data-target="about">About Us</a>
      <a id="nav-match" class="nav-item" data-target="match">Events</a>
      <a id="nav-chat" class="nav-item" data-target="chat">Chat</a>
      <a id="nav-profile" class="nav-item" data-target="profile">Profile</a>
      <a id="nav-settings" class="nav-item" data-target="settings">Preferences</a>
      <a id="nav-calendar" class="nav-item" data-target="calendar">Calendar</a>
      <a id="nav-survey" class="nav-item" data-target="survey">Survey</a>
      <button id="dark-toggle">üåô</button>
      <div id="auth-area">
        <a data-target="login">Log In</a>
        <a data-target="register" class="btn-primary">Sign Up</a>
        <a data-target="forgot-password">Forgot Password</a>
      </div>
      <div id="user-email"></div>
      <button id="sign-out" onclick="signOutUser()">Sign Out</button>
    </nav>
  </header>

  <main>
    <section id="home" class="page active">
      <div class="hero">
        <h1>Discover<br>Meaningful<br>Connections</h1>
        <p>Join IMEET4U and start your romantic journey</p>
        <a class="btn-primary" data-target="register">Join Now</a>
      </div>
      <div class="features">
        <div class="feature-card"><img src="MATCH.png" alt="Match Icon"><h3>Events System</h3><p>Join weekly events to meet new people</p></div>
        <div class="feature-card"><img src="CHAT.png" alt="Chat Icon"><h3>Instant Chat</h3><p>One-on-one chat for real interaction</p></div>
        <div class="feature-card"><img src="PROFILE.png" alt="Profile Icon"><h3>Profile</h3><p>Show your true self</p></div>
        <div class="feature-card"><img src="PREFERENCE.png" alt="Preferences Icon"><h3>Preferences</h3><p>Customize filters to optimize matching</p></div>
      </div>
    </section>

    <section id="about" class="page">
      <h2>About Us</h2>
      <p>IMEET4U is a dating app designed for modern singles, providing powerful matching, chat, and customization features to help you connect with like-minded people.</p>
      <h2>Meet Our Team</h2>
      <section class="team-section">
        <div class="team-members">
          <div class="member">
            <img src="Jack.jpg" alt="Guan-Yi Wu">
            <h3>Guan-Yi Wu (Jack)</h3>
            <p>Information Management, NTPU</p>
          </div>
          <div class="member">
            <img src="Jerry.png" alt="Zhong-Rui Tsai">
            <h3>Zhong-Rui Tsai (Jerry)</h3>
            <p>Information Management, NTPU</p>
          </div>
          <div class="member">
            <img src="Najeeb.png" alt="Najeeb Ullah">
            <h3>Najeeb Ullah (Nur)</h3>
            <p>Smart Healthcare and Management, NTPU</p>
          </div>
        </div>
      </section>
    </section>

    <section id="match" class="page">
      <h2>Weekly Events</h2>
      <div id="swipe-container">
        <!-- Á∏£Â∏Ç„ÄÅÊ¥ªÂãï„ÄÅÊôÇÈñìË°®Â∞áÂãïÊÖãÁîüÊàê -->
      </div>
      <div id="selected-info" class="selected-info"></div>
    </section>

    <section id="chat" class="page">
      <h2>Chat</h2>
      <div id="chat-window"></div>
      <div class="input-group">
        <input id="msg" placeholder="Type a message...">
        <button id="send">Send</button>
      </div>
    </section>

    <section id="profile" class="page">
      <h2>My Profile</h2>
      <form class="form-container" id="profile-form">
        <label>Name:<input name="name" required></label>
        <label>Introduction:<textarea name="bio" required></textarea></label>
        <button type="submit" onclick="saveProfile(); return false;">Save</button>
      </form>
    </section>

    <section id="settings" class="page">
      <h2>Preferences</h2>
      <form class="form-container" id="settings-form">
        <label>Gender Preference:
          <select name="gender">
            <option>No Preference</option>
            <option>Female</option>
            <option>Male</option>
          </select>
        </label>
        <label>Age Range:<input type="number" name="ageMin" placeholder="Min"> ‚Äì <input type="number" name="ageMax" placeholder="Max"></label>
        <button type="submit">Save Settings</button>
      </form>
    </section>

    <section id="calendar" class="page">
      <h2>Calendar - May 2025</h2>
      <div class="calendar" id="calendar-grid"></div>
    </section>

    <section id="login" class="page">
      <div class="form-container">
        <h2>Log In</h2>
        <form id="login-form">
          <label>Username or Email:<input name="username" required></label>
          <label>Password:<input type="password" name="password" required></label>
          <button type="submit">Log In</button>
        </form>
        <p><a data-target="forgot-password">Forgot Password?</a></p>
      </div>
    </section>

    <section id="register" class="page">
      <div class="form-container">
        <h2>Sign Up</h2>
        <form id="register-form">
          <label>Email:<input type="email" name="email" id="userEmail" required></label>
          <label>Password:<input type="password" name="password" id="userPassword" required minlength="6"></label>
          <label>Confirm Password:<input type="password" name="confirm_password" id="userCPassword" required></label>
          <button type="submit" id="sign-up-btn">Sign Up</button>
        </form>
      </div>
    </section>

    <section id="forgot-password" class="page">
      <div class="form-container">
        <h2>Forgot Password</h2>
        <form id="forgot-password-form">
          <label>Email:<input type="email" id="reset-email" required></label>
          <button type="submit" onclick="resetPassword(); return false;">Send Reset Email</button>
        </form>
        <p id="debug-output"></p>
        <p><a data-target="login">Back to Log In</a></p>
      </div>
    </section>

    <section id="survey" class="page">
      <h2>Personality Survey</h2>
      <div class="form-container">
        <form id="survey-form">
          <div class="survey-question">
            <label>1. What's your favorite sport? (Select up to 2)</label>
            <div>
              <label><input type="checkbox" name="favoriteSport" value="Basketball"> Basketball</label>
              <label><input type="checkbox" name="favoriteSport" value="Volleyball"> Volleyball</label>
              <label><input type="checkbox" name="favoriteSport" value="Badminton"> Badminton</label>
              <label><input type="checkbox" name="favoriteSport" value="Pool"> Pool</label>
              <label><input type="checkbox" name="favoriteSport" value="Tennis"> Tennis</label>
              <label><input type="checkbox" name="favoriteSport" value="Table Tennis"> Table Tennis</label>
            </div>
          </div>

          <div class="survey-question">
            <label>2. What do you like to do in your free time? (Select up to 2)</label>
            <div>
              <label><input type="checkbox" name="freeTimeActivities" value="Singing"> Singing</label>
              <label><input type="checkbox" name="freeTimeActivities" value="Dancing"> Dancing</label>
              <label><input type="checkbox" name="freeTimeActivities" value="Reading"> Reading</label>
              <label><input type="checkbox" name="freeTimeActivities" value="Watching Movies"> Watching Movies</label>
              <label><input type="checkbox" name="freeTimeActivities" value="Exercising"> Exercising</label>
              <label><input type="checkbox" name="freeTimeActivities" value="Traveling"> Traveling</label>
            </div>
          </div>

          <div class="survey-question">
            <label>3. How much time do you usually spend on your hobbies? (Select one)</label>
            <div>
              <label><input type="radio" name="timeOnHobbies" value="Less than 1 hour"> Less than 1 hour</label>
              <label><input type="radio" name="timeOnHobbies" value="2 hours"> 2 hours</label>
              <label><input type="radio" name="timeOnHobbies" value="3 hours"> 3 hours</label>
              <label><input type="radio" name="timeOnHobbies" value="More than 4 hours"> More than 4 hours</label>
            </div>
          </div>

          <div class="survey-question">
            <label>4. What kind of music do you like? (Select up to 2)</label>
            <div>
              <label><input type="checkbox" name="musicPreference" value="Classical"> Classical</label>
              <label><input type="checkbox" name="musicPreference" value="Rock"> Rock</label>
              <label><input type="checkbox" name="musicPreference" value="Pop"> Pop</label>
              <label><input type="checkbox" name="musicPreference" value="Romantic"> Romantic</label>
              <label><input type="checkbox" name="musicPreference" value="Love Song"> Love Song</label>
            </div>
          </div>

          <div class="survey-question">
            <label>5. What type of books do you like? (Select up to 2)</label>
            <div>
              <label><input type="checkbox" name="bookPreference" value="Romance"> Romance</label>
              <label><input type="checkbox" name="bookPreference" value="Horror"> Horror</label>
              <label><input type="checkbox" name="bookPreference" value="Martial Arts"> Martial Arts</label>
              <label><input type="checkbox" name="bookPreference" value="Suspense"> Suspense</label>
              <label><input type="checkbox" name="bookPreference" value="Fantasy"> Fantasy</label>
              <label><input type="checkbox" name="bookPreference" value="Animation"> Animation</label>
            </div>
          </div>

          <div class="survey-question">
            <label>6. What kind of movies do you like? (Select up to 2)</label>
            <div>
              <label><input type="checkbox" name="moviePreference" value="Romance"> Romance</label>
              <label><input type="checkbox" name="moviePreference" value="Horror"> Horror</label>
              <label><input type="checkbox" name="moviePreference" value="Martial Arts"> Martial Arts</label>
              <label><input type="checkbox" name="moviePreference" value="Suspense"> Suspense</label>
              <label><input type="checkbox" name="moviePreference" value="Fantasy"> Fantasy</label>
              <label><input type="checkbox" name="moviePreference" value="Animation"> Animation</label>
            </div>
          </div>

          <div class="survey-question">
            <label>7. How would you rate your personality? (1 is more introverted and shy, 10 is more extroverted and lively)</label>
            <div>
              <label><input type="radio" name="personalityRating" value="1"> 1</label>
              <label><input type="radio" name="personalityRating" value="2"> 2</label>
              <label><input type="radio" name="personalityRating" value="3"> 3</label>
              <label><input type="radio" name="personalityRating" value="4"> 4</label>
              <label><input type="radio" name="personalityRating" value="5"> 5</label>
              <label><input type="radio" name="personalityRating" value="6"> 6</label>
              <label><input type="radio" name="personalityRating" value="7"> 7</label>
              <label><input type="radio" name="personalityRating" value="8"> 8</label>
              <label><input type="radio" name="personalityRating" value="9"> 9</label>
              <label><input type="radio" name="personalityRating" value="10"> 10</label>
            </div>
          </div>

          <button type="submit" onclick="saveSurvey(); return false;">Save</button>
        </form>
      </div>
    </section>
  </main>

  <footer>¬© 2025 IMEET4U. All Rights Reserved.</footer>
</body>
</html>
